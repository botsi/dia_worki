function daysInMonth(e,t){return new Date(t,e,0).getDate()}function weekend(e){var t=new Date(today[0].getFullYear(),today[0].getMonth(),e).getDay();return 0!=t&&6!=t&&freedays.indexOf(e+".")==-1&&t}function loadXMLDoc(e,t,a){xmlhttp=new XMLHttpRequest,xmlhttp.onreadystatechange=t,"undefined"==typeof a?(xmlhttp.open("GET",e,!0),xmlhttp.send()):(xmlhttp.open("POST",e,!0),xmlhttp.setRequestHeader("expires","0"),xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xmlhttp.send(a))}var today=[new Date];today.push(daysInMonth(today[0].getMonth()+1,today[0].getFullYear()),today[0].getMonth(),today[0].getFullYear());var freedays=["14.","17."],quarter=function(e,t){switch(!0){case t<0:e.nextSibling.value=""!=e.nextSibling.value?parseFloat(e.nextSibling.value)+ +parseFloat(t):7;break;case t>0:e.previousSibling.value=""!=e.previousSibling.value?parseFloat(e.previousSibling.value)+parseFloat(t):7;break;default:e.previousSibling.previousSibling.value=""}},sevenifzero=function(e){""==e.parentNode.parentNode.getElementsByClassName("z")[0].value&&(e.parentNode.parentNode.getElementsByClassName("z")[0].value=7)},optional=function(e,t){e.children[0].classList.contains("fake_checkbox_vis")?(e.children[0].classList.remove("fake_checkbox_vis"),e.children[1].value=""):(e.children[0].classList.add("fake_checkbox_vis"),e.children[1].value="X")},fillTableDays=function(e){for(var t=e.children[0].children.length,a=1;a<today[1]+1;a++){var n=document.createElement("tr");n.innerHTML="<td>"+(weekend(a)?adjustments_de.dayNamesMin[weekend(a)]:"")+"</td>",n.innerHTML+='<td class="d">'+a+".</td>",n.innerHTML+='<td><i class="fa fa-minus-circle" aria-hidden="true" onclick="quarter(this,-0.5)"></i><input class="z" type="text" id="z'+a+'" value="'+select_pdf.save_raws.z[a-1]+'" onfocus="this.value = 7;this.blur();" /><i class="fa fa-plus-circle" aria-hidden="true" onclick="quarter(this,0.5)"></i><i class="fa fa-times-circle" aria-hidden="true" onclick="quarter(this,0)"></i></td>';for(var s=3;s<t-1;s++)n.innerHTML+='<td class="fa-check_parent" onclick="optional(this,'+s+')"><i class="fa fa-check fake_checkbox '+(""!=select_pdf.save_raws["hi"+s][a-1]?"fake_checkbox_vis":"")+'" aria-hidden="true"></i><input class="hi'+s+'" type="hidden" value="'+select_pdf.save_raws["hi"+s][a-1]+'" /></td>';n.innerHTML+='<td><input onblur="sevenifzero(this)" tabindex="'+a+'" class="b" type="text" id="b'+a+'" value="'+select_pdf.save_raws.b[a-1]+'" /></td>',weekend(a)||n.classList.add("freeday"),e.appendChild(n)}};adjustments_de={dayNames:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],dayNamesMin:["So","Mo","Di","Mi","Do","Fr","Sa"],monthNames:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthNamesMin:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],years:[]};var define=function(){var e=document.getElementById("f1"),t=document.getElementById("f2"),a=document.getElementById("f3"),n=document.getElementById("f4");e.value=user.name+", "+user.vorname,t.value=user.einsatzplatz,a.value=user.beschäftigungsgrad,n.value=user.berater,fillTableDays(document.getElementById("form_body").children[0]),select_pdf.get_scr()},text_load=function(){loadXMLDoc("presets/presets.js",function(){4==xmlhttp.readyState&&(200==xmlhttp.status?(base=JSON.parse(xmlhttp.responseText).base,user=JSON.parse(xmlhttp.responseText).user,loadXMLDoc("presets/data.txt",function(){4==xmlhttp.readyState&&(200==xmlhttp.status?(select_pdf.save_raws=JSON.parse(xmlhttp.responseText),define()):alert("presets data shit happens"))})):alert("presets shit happens"))})},pdf_m=!1,select_pdf={get_scr:function(){if(!pdf_m){var e=document.createElement("script");e.onload=function(){var e=document.createElement("script");e.onload=function(){var e=document.createElement("script");e.src="images/pdf_head_base64.js",e.charset="utf-8",document.head.appendChild(e)},e.src="scripts/vfs_fonts.js",e.charset="utf-8",document.head.appendChild(e)},e.src="scripts/pdfmake.min.js",e.charset="utf-8",document.head.appendChild(e),pdf_m=!0}},collect:function(){var e=[[{text:"Tätigkeiten",fontSize:10,bold:!0},{text:"Eingeführt Datum",bold:!0},{text:"*",bold:!0},{text:"Visum Vorgesetzter",bold:!0}]],t=[[{text:"",fontSize:10},{text:"Tag",bold:!0},{text:"Arbeitszeit\nin Stunden",bold:!0},{text:"Kurse",bold:!0},{text:"Vorstellen\nSchnuppern",bold:!0},{text:"Krank\nUnfall",bold:!0},{text:"RAV",bold:!0},{text:"Ferien",bold:!0},{text:"Anderes*",bold:!0},{text:"Bemerkungen",bold:!0}]],a=document.getElementById("form_body").getElementsByTagName("tr");select_pdf.save_raws={d:[],z:[],hi3:[],hi4:[],hi5:[],hi6:[],hi7:[],hi8:[],b:[]};for(var n=1;n<a.length;n++)""!=a[n].getElementsByClassName("b")[0].value&&e.push([a[n].getElementsByClassName("b")[0].value,a[n].getElementsByClassName("d")[0].innerHTML+" "+adjustments_de.monthNames[today[2]],"A",""]),select_pdf.save_raws.d.push(a[n].getElementsByClassName("d")[0].innerHTML),select_pdf.save_raws.z.push(a[n].getElementsByClassName("z")[0].value),select_pdf.save_raws.hi3.push(a[n].getElementsByClassName("hi3")[0].value),select_pdf.save_raws.hi4.push(a[n].getElementsByClassName("hi4")[0].value),select_pdf.save_raws.hi5.push(a[n].getElementsByClassName("hi5")[0].value),select_pdf.save_raws.hi6.push(a[n].getElementsByClassName("hi6")[0].value),select_pdf.save_raws.hi7.push(a[n].getElementsByClassName("hi7")[0].value),select_pdf.save_raws.hi8.push(a[n].getElementsByClassName("hi8")[0].value),select_pdf.save_raws.b.push(a[n].getElementsByClassName("b")[0].value),t.push(["",{text:a[n].getElementsByClassName("d")[0].innerHTML,alignment:"center"},{text:a[n].getElementsByClassName("z")[0].value,alignment:"center"},{text:a[n].getElementsByClassName("hi3")[0].value,alignment:"center"},{text:a[n].getElementsByClassName("hi4")[0].value,alignment:"center"},{text:a[n].getElementsByClassName("hi5")[0].value,alignment:"center"},{text:a[n].getElementsByClassName("hi6")[0].value,alignment:"center"},{text:a[n].getElementsByClassName("hi7")[0].value,alignment:"center"},{text:a[n].getElementsByClassName("hi8")[0].value,alignment:"center"},{text:a[n].getElementsByClassName("b")[0].value}]);download_pdf(e,t)}},base64,download_pdf=function(e,t){var a={pageSize:"A4",content:[],styles:{header:{fontSize:18,bold:!0},smallheader:{fontSize:12,bold:!0},mini:{fontSize:8},defaultStyle:{fontSize:10}}};a.content.push({image:base64,alignment:"right",width:147}),a.content.push({text:"Tätigkeitsbericht",style:"header"},{text:"AMM Berner Stellennetz\n\nTeilnehmer/in: "+f1.value+"\n\nEinsatzplatz: "+f2.value,fontSize:10},{text:"\n\n",fontSize:10},{fontSize:10,table:{widths:[300,80,"auto",90],body:e}},{text:"*Beurteilung: A = hervorragend B = gut C = mässig D = ungenügend\n",bold:!0},{fontSize:10,table:{widths:[250,"*"],body:[["Datum: ",today[0].getDate()+". "+adjustments_de.monthNames[today[2]]+" "+today[3]],["Visum verantwortliche Fachperson / Leitung:",""]]},layout:"noBorders"},{text:"Mit der Unterzeichnung bescheinigt der/die Teilnehmer/in:\n- vom Inhalt dieses Berichts Kenntnis genommen zu haben\n- über die Weiterleitung dieses Dokuments an den Personalberater der RAV informiert worden zu sein",fontSize:10,bold:!0},{fontSize:10,table:{widths:[250,"*"],body:[["Visum Teilnehmer/in:",user.vorname+" "+user.name]]},layout:"noBorders"},{text:base.adress_tb,style:"mini"}),a.content.push({image:base64,alignment:"right",width:147,pageBreak:"before"}),a.content.push({text:"Einsatz-Kontrollblatt AMM Berner Stellennetz",style:"smallheader",margin:[0,-40,0,0]},{text:base.adress_ek,margin:0},{fontSize:10,table:{widths:[100,"auto","*"],body:[[{text:"Name / Vorname:",bold:!0},{text:f1.value,bold:!0},{text:"Monat: "+adjustments_de.monthNames[today[2]]+" "+today[3],bold:!0,alignment:"right"}],["Einsatzplatz:",f2.value,{text:f4.value,alignment:"right"}],["Beschäftigungsgrad:",f3.value,""]]},layout:"noBorders"},{text:["\nDamit Sie ihr Arbeitslosentaggeld erhalten, senden Sie das vollständig ausgefüllte (inkl. Prognose) und durch die oder den Vorgesetzte/n unterschriebene Einsatzkontrollblatt ",{text:"ab dem 25. des Monates",bold:!0}," an das Berner Stellennetz."],style:"defaultStyle"},{text:["Bei Einsatzende oder -abbruch bitte ",{text:"sofort",bold:!0}," einreichen (Kontaktdaten siehe Kopfzeile)."],style:"defaultStyle"},{text:"\nHinweis: Kompensationsstunden sind unter den Bemerkungen einzutragen.",style:"defaultStyle"},{fontSize:10,table:{widths:[30,"auto","auto","auto","auto","auto","auto","auto","auto","*"],body:t}},{text:"\n* vergleiche dazu Anhang zur Einsatzvereinbarung, Abwesenheiten (entschuldigte Absenzen)\n",style:"mini"},{text:["Datum: "+today[0].getDate()+". "+adjustments_de.monthNames[today[2]]+" "+today[3]+"   Visum Vorgesetzte/r Einsatzplatz:"],style:"smallheader"}),pdfMake.createPdf(a).download("taetigkeitsbericht_"+adjustments_de.monthNames[today[2]].replace("ä","ae")+".pdf");var n=JSON.stringify(select_pdf.save_raws);loadXMLDoc("scripts/up_data.php",function(){4==xmlhttp.readyState&&(200==xmlhttp.status||console.log("save_raws shit happens, sorry!"))},"path=presets/data&newtext="+encodeURIComponent(n))};document.addEventListener("DOMContentLoaded",text_load,!1);