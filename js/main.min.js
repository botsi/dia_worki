function daysInMonth(e,t){return new Date(t,e,0).getDate()}function weekend(e){var t=new Date(today[0].getFullYear(),today[0].getMonth(),e).getDay();return 0!=t&&6!=t&&adjustments_de.freedays[today[0].getMonth()].indexOf(e+".")==-1&&t}function loadXMLDoc(e,t,a){xmlhttp=new XMLHttpRequest,xmlhttp.onreadystatechange=t,"undefined"==typeof a?(xmlhttp.open("GET",e,!0),xmlhttp.send()):(xmlhttp.open("POST",e,!0),xmlhttp.setRequestHeader("expires","0"),xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xmlhttp.send(a))}var today,d2,d1,arrow=function(e){if(e||(e=window.event),13==e.keyCode){window.removeEventListener("keyup",arrow,!1),d2=2==document.getElementById("d2").value.length?"20"+document.getElementById("d2").value:document.getElementById("d2").value;var t=document.getElementById("d1").value;t=t.charAt(0).toUpperCase()+t.slice(1),d1=adjustments_de.monthNames.indexOf(t)!=-1?adjustments_de.monthNames.indexOf(t):parseInt(document.getElementById("d1").value)-1,today=(new Date).getMonth()==d1?[new Date]:[new Date(d2,parseInt(d1)+1,0)],today.push(daysInMonth(today[0].getMonth()+1,today[0].getFullYear()),today[0].getMonth(),today[0].getFullYear()),document.getElementById("header").children[0].innerHTML+=" "+adjustments_de.monthNames[d1]+" "+d2,document.getElementById("start").style.display="none",text_load(d2,d1)}},quarter=function(e,t){var a=e.parentNode.getElementsByClassName("z")[0];switch(!0){case t<0:a.value=""!=a.value?parseFloat(a.value)+ +parseFloat(t):7,a.value<=0&&(a.value="");break;case t>0:a.value=""!=a.value?parseFloat(a.value)+parseFloat(t):7;break;default:a.value=""}sh_z_edit(a)},sevenifzero=function(e){""!=e.value&&""==e.parentNode.parentNode.getElementsByClassName("z")[0].value&&(e.parentNode.parentNode.getElementsByClassName("z")[0].value=7),sh_z_edit(e.parentNode.parentNode.getElementsByClassName("z")[0])},sh_z_edit=function(e){console.log("ichange"),e.nextSibling.nextSibling.style.visibility=""!=e.value?"visible":"hidden"},optional=function(e,t){e.children[0].classList.contains("fake_checkbox_vis")?(e.children[0].classList.remove("fake_checkbox_vis"),e.children[1].value=""):(e.children[0].classList.add("fake_checkbox_vis"),e.children[1].value="X")},fillTableDays=function(e){for(var t=e.children[0].children.length,a=1;a<today[1]+1;a++){var n=document.createElement("tr");n.innerHTML="<td>"+(weekend(a)?adjustments_de.dayNamesMin[weekend(a)]:"")+"</td>",n.innerHTML+='<td class="d">'+a+".</td>",n.innerHTML+='<td><i class="fa fa-minus-circle" aria-hidden="true" onclick="quarter(this,-0.5)"></i><input class="z" type="text" id="z'+a+'" value="'+select_pdf.save_raws.z[a-1]+'" onfocus="this.value = 7;this.blur();" /><i class="fa fa-plus-circle" aria-hidden="true" onclick="quarter(this,0.5)"></i><i class="fa fa-times-circle" aria-hidden="true" onclick="quarter(this,0)"'+(""!=select_pdf.save_raws.z[a-1]?' style="visibility:visible;"':"")+"></i></td>";for(var s=3;s<t-1;s++)n.innerHTML+='<td class="fa-check_parent" onclick="optional(this,'+s+')"><i class="fa fa-check fake_checkbox '+(""!=select_pdf.save_raws["hi"+s][a-1]?"fake_checkbox_vis":"")+'" aria-hidden="true"></i><input class="hi'+s+'" type="hidden" value="'+select_pdf.save_raws["hi"+s][a-1]+'" /></td>';n.innerHTML+='<td><input onblur="sevenifzero(this)" tabindex="'+a+'" class="b" type="text" id="b'+a+'" value="'+select_pdf.save_raws.b[a-1]+'" /></td>',weekend(a)||n.classList.add("freeday"),a>today[0].getDate()&&n.classList.add("future"),e.appendChild(n)}};adjustments_de={freedays:[["1.","2."],[],[],["14.","17."],["1.","25."],["5."],[],["1."],[],[],[],["25.","26.","31."]],dayNames:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],dayNamesMin:["So","Mo","Di","Mi","Do","Fr","Sa"],monthNames:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthNamesMin:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],years:[]};var define=function(){var e=document.getElementById("f1"),t=document.getElementById("f2"),a=document.getElementById("f3"),n=document.getElementById("f4");e.value=user.name+", "+user.vorname,t.value=user.einsatzplatz,a.value=user.beschäftigungsgrad,n.value=user.berater,fillTableDays(document.getElementById("form_body").children[0]),select_pdf.get_scr()},set_timespan=function(){document.getElementById("d1").value=adjustments_de.monthNames[(new Date).getMonth()],document.getElementById("d2").value=(new Date).getFullYear(),window.addEventListener("keyup",arrow,!1)},text_load=function(e,t){loadXMLDoc("presets/presets.js",function(){4==xmlhttp.readyState&&(200==xmlhttp.status?(base=JSON.parse(xmlhttp.responseText).base,user=JSON.parse(xmlhttp.responseText).user,loadXMLDoc("presets/data_"+e+"_"+t+".txt",function(){if(4==xmlhttp.readyState)if(200==xmlhttp.status)select_pdf.save_raws=JSON.parse(xmlhttp.responseText),define();else{alert("No month file! A new one will be created."),console.log(today[1]);for(var e=[],t=0;t<today[1];t++)e.push("");select_pdf.save_raws={d:e,z:e,hi3:e,hi4:e,hi5:e,hi6:e,hi7:e,hi8:e,b:e},define()}})):alert("presets shit happens"))})},pdf_m=!1,select_pdf={disable:!1,sh_pdf:function(e){e.children[0].classList.contains("check_pdf_dis")?(e.children[0].classList.remove("check_pdf_dis"),select_pdf.disable=!1):(e.children[0].classList.add("check_pdf_dis"),select_pdf.disable=!0)},get_scr:function(){if(!pdf_m){var e=document.createElement("script");e.onload=function(){var e=document.createElement("script");e.onload=function(){var e=document.createElement("script");e.src="images/pdf_head_base64.js",e.charset="utf-8",document.head.appendChild(e)},e.src="scripts/vfs_fonts.js",e.charset="utf-8",document.head.appendChild(e)},e.src="scripts/pdfmake.min.js",e.charset="utf-8",document.head.appendChild(e),pdf_m=!0}},collect:function(){var e=[[{text:"Tätigkeiten",fontSize:8,bold:!0},{text:"Eingeführt Datum",fontSize:8,bold:!0},{text:"*",fontSize:8,bold:!0},{text:"Visum Vorgesetzter",fontSize:8,bold:!0}]],t=[[{text:"",fontSize:10},{text:"Tag",bold:!0},{text:"Arbeitszeit\nin Stunden",bold:!0},{text:"Kurse",bold:!0},{text:"Vorstellen\nSchnuppern",bold:!0},{text:"Krank\nUnfall",bold:!0},{text:"RAV",bold:!0},{text:"Ferien",bold:!0},{text:"Anderes*",bold:!0},{text:"Bemerkungen",bold:!0}]],a=document.getElementById("form_body").getElementsByTagName("tr");select_pdf.save_raws={d:[],z:[],hi3:[],hi4:[],hi5:[],hi6:[],hi7:[],hi8:[],b:[]};for(var n=1;n<a.length;n++)""!=a[n].getElementsByClassName("b")[0].value&&e.push([a[n].getElementsByClassName("b")[0].value,a[n].getElementsByClassName("d")[0].innerHTML+" "+adjustments_de.monthNames[today[2]],"A",""]),select_pdf.save_raws.d.push(a[n].getElementsByClassName("d")[0].innerHTML),select_pdf.save_raws.z.push(a[n].getElementsByClassName("z")[0].value),select_pdf.save_raws.hi3.push(a[n].getElementsByClassName("hi3")[0].value),select_pdf.save_raws.hi4.push(a[n].getElementsByClassName("hi4")[0].value),select_pdf.save_raws.hi5.push(a[n].getElementsByClassName("hi5")[0].value),select_pdf.save_raws.hi6.push(a[n].getElementsByClassName("hi6")[0].value),select_pdf.save_raws.hi7.push(a[n].getElementsByClassName("hi7")[0].value),select_pdf.save_raws.hi8.push(a[n].getElementsByClassName("hi8")[0].value),select_pdf.save_raws.b.push(a[n].getElementsByClassName("b")[0].value),t.push(["",{text:a[n].getElementsByClassName("d")[0].innerHTML,alignment:"center"},{text:a[n].getElementsByClassName("z")[0].value,alignment:"center"},{text:a[n].getElementsByClassName("hi3")[0].value,alignment:"center"},{text:a[n].getElementsByClassName("hi4")[0].value,alignment:"center"},{text:a[n].getElementsByClassName("hi5")[0].value,alignment:"center"},{text:a[n].getElementsByClassName("hi6")[0].value,alignment:"center"},{text:a[n].getElementsByClassName("hi7")[0].value,alignment:"center"},{text:a[n].getElementsByClassName("hi8")[0].value,alignment:"center"},{text:a[n].getElementsByClassName("b")[0].value}]);download_pdf(e,t)}},base64,download_pdf=function(e,t){var a={footer:function(e,t){return 1==e||2==e&&t>3?{text:base.adress_tb,style:"mini",margin:[40,-36,0,0]}:e==t?[{text:["Datum: "+today[0].getDate()+". "+adjustments_de.monthNames[today[2]]+" "+today[3]+"   Visum Vorgesetzte/r Einsatzplatz:"],style:"smallheader",margin:[40,-48,0,0]},{canvas:[{type:"line",x1:380,y1:12,x2:552,y2:12,lineWidth:1}]}]:""},pageSize:"A4",content:[],styles:{header:{fontSize:18,bold:!0,margin:[0,-20,0,0]},smallheader:{fontSize:12,bold:!0},mini:{fontSize:8},defaultStyle:{fontSize:10}}};a.content.push({image:base64,alignment:"right",width:147}),a.content.push({text:"Tätigkeitsbericht",style:"header"},{text:"AMM Berner Stellennetz\n\nTeilnehmer/in: "+f1.value+"\n\nEinsatzplatz: "+f2.value,fontSize:10},{text:"\n\n",fontSize:10},{fontSize:10,table:{widths:[320,70,"auto",80],body:e}},{text:"*Beurteilung: A = hervorragend B = gut C = mässig D = ungenügend\n\n",bold:!0},{fontSize:10,table:{widths:[256,"*"],body:[["Datum: ",today[0].getDate()+". "+adjustments_de.monthNames[today[2]]+" "+today[3]],["",""],["Visum verantwortliche Fachperson / Leitung:",""]]},layout:"noBorders"},{canvas:[{type:"line",x1:256,y1:0,x2:512,y2:0,lineWidth:1}]},{text:"\nMit der Unterzeichnung bescheinigt der/die Teilnehmer/in:\n- vom Inhalt dieses Berichts Kenntnis genommen zu haben\n- über die Weiterleitung dieses Dokuments an den Personalberater der RAV informiert worden zu sein\n\n\n",fontSize:10,bold:!0},{fontSize:10,table:{widths:[256,256],body:[["Visum Teilnehmer/in:",""]]},layout:"noBorders"},{canvas:[{type:"line",x1:256,y1:0,x2:512,y2:0,lineWidth:1}]},{fontSize:10,table:{widths:[256,256],body:[["",{text:user.vorname+" "+user.name,alignment:"center"}]]},layout:"noBorders"}),a.content.push({image:base64,alignment:"right",width:147,pageBreak:"before"}),a.content.push({text:"Einsatz-Kontrollblatt AMM Berner Stellennetz",style:"smallheader",margin:[0,-40,0,0]},{text:base.adress_ek,margin:0},{fontSize:10,table:{widths:[100,"auto","*"],body:[[{text:"Name / Vorname:",bold:!0},{text:f1.value,bold:!0},{text:"Monat: "+adjustments_de.monthNames[today[2]]+" "+today[3],bold:!0,alignment:"right"}],["Einsatzplatz:",f2.value,{text:f4.value,alignment:"right"}],["Beschäftigungsgrad:",f3.value,""]]},layout:"noBorders"},{text:["\nDamit Sie ihr Arbeitslosentaggeld erhalten, senden Sie das vollständig ausgefüllte (inkl. Prognose) und durch die oder den Vorgesetzte/n unterschriebene Einsatzkontrollblatt ",{text:"ab dem 25. des Monates",bold:!0}," an das Berner Stellennetz."],style:"defaultStyle"},{text:["Bei Einsatzende oder -abbruch bitte ",{text:"sofort",bold:!0}," einreichen (Kontaktdaten siehe Kopfzeile)."],style:"defaultStyle"},{text:"\nHinweis: Kompensationsstunden sind unter den Bemerkungen einzutragen.",style:"defaultStyle"},{fontSize:10,table:{widths:[30,"auto","auto","auto","auto","auto","auto","auto","auto","*"],body:t}},{text:"\n* vergleiche dazu Anhang zur Einsatzvereinbarung, Abwesenheiten (entschuldigte Absenzen)\n",style:"mini"}),select_pdf.disable||pdfMake.createPdf(a).download("taetigkeitsbericht_"+adjustments_de.monthNames[today[2]].replace("ä","ae")+".pdf");var n=JSON.stringify(select_pdf.save_raws);loadXMLDoc("scripts/up_data.php",function(){4==xmlhttp.readyState&&(200==xmlhttp.status||console.log("save_raws shit happens, sorry!"))},"path=presets/data_"+d2+"_"+d1+"&newtext="+encodeURIComponent(n))};document.addEventListener("DOMContentLoaded",set_timespan,!1);